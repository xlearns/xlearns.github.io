{"version":3,"file":"useStyleSider.7b813e07.js","sources":["../../src/hooks/usePanel.js","../../src/hooks/useStyleSider.js"],"sourcesContent":["import { ref, computed } from \"vue\";\nimport * as CONFIG from \"@/constants/config\";\n\nlet list = ref([]);\nlet isMenuDown = ref(false);\nlet widgetX = ref(0);\nlet widgetY = ref(0);\nlet currentWidget = ref(null);\nlet scalc = ref(100);\nlet drawer = ref(false);\nlet rootStyle = ref({\n  width: 1920,\n  height: 1080,\n});\n\nexport function usePanel() {\n  let current = computed(() => {\n    return list.value.find((item) => item.focused);\n  });\n\n  // 当前组件的样式\n  let currentForm = computed(() => {\n    // return CONFIG.WIDGE_LIST.find((item) => current.value?.type === item.type)\n    //   ?.styleForm;\n    return current.value?.styleForm;\n  });\n\n  function onFocus(currentItem) {\n    list.value = list.value.map((item) => {\n      item.focused = item.id === currentItem.id;\n      return item;\n    });\n  }\n  function onBlursAll() {\n    list.value = list.value.map((item) => {\n      item.focused = false;\n      return item;\n    });\n  }\n  function onBlurs(currentItem) {\n    if (isMenuDown.value) return;\n    currentItem.focused = false;\n  }\n\n  function contextmenu(event) {\n    return event.preventDefault();\n  }\n  function onWidgetDrag(info, currentItem) {\n    let { left: x, top: y } = info;\n    list.value = list.value.map((item) => {\n      if (item.id === currentItem) {\n        item.x = x;\n        item.y = y;\n      }\n      return item;\n    });\n  }\n  function sortList() {\n    list.value.sort((a, b) => b.z - a.z);\n  }\n\n  function layerUp() {\n    let currentItem = current.value;\n    // 找到当前组件的上一个组件\n    let up = list.value.find(\n      (item) => item.z === currentItem.z + 1 && item.id !== currentItem.id\n    );\n    up && up.z--;\n    currentItem.z++;\n  }\n  function layerDn() {\n    let currentItem = current.value;\n    // 找到当前组件的下一个组件\n    let dn = list.value.find(\n      (item) => item.z === currentItem.z - 1 && item.id !== currentItem.id\n    );\n    dn && dn.z++;\n    currentItem.z--;\n  }\n  function deleteFn() {\n    list.value = list.value.filter((item) => !item.focused);\n  }\n  function layerTop() {\n    const currentItem = current.value;\n    let max = Math.max(...list.value.map((item) => item.z));\n    if (typeof max != \"number\") return;\n    currentItem.z = max + 1;\n  }\n  function layerBottom() {\n    const currentItem = current.value;\n    let min = Math.min(...list.value.map((item) => item.z));\n    if (typeof min != \"number\") return;\n    currentItem.z = min - 1;\n  }\n\n  function onWidgetMouseDown(event, widget) {\n    let { offsetX, offsetY } = event;\n    widgetX.value = offsetX;\n    widgetY.value = offsetY;\n    currentWidget.value = widget;\n  }\n\n  return {\n    drawer,\n    onBlursAll,\n    onBlurs,\n    scalc,\n    contextmenu,\n    widgetX,\n    widgetY,\n    currentWidget,\n    onWidgetMouseDown,\n    onFocus,\n    current,\n    list,\n    currentForm,\n    sortList,\n    onWidgetDrag,\n    layerUp,\n    layerDn,\n    deleteFn,\n    layerTop,\n    layerBottom,\n    rootStyle,\n    isMenuDown,\n  };\n}\n","import { ref } from \"vue\";\nimport { usePanel } from \"@/hooks/usePanel\";\nlet { current, list, rootStyle: rs } = usePanel();\n// 只有放到函数外面，才会是全局响应式\nlet bgImg = ref(\"./bg.png\");\n\nlet data = ref([\n  \"左对齐\",\n  \"右对齐\",\n  \"顶部对齐\",\n  \"底部对齐\",\n  \"垂直居中\",\n  \"水平居中\",\n]);\n\nexport function useStyle() {\n  let PosAndSize = ref([\n    [\n      {\n        label: \"X\",\n        key: \"x\",\n      },\n      {\n        label: \"Y\",\n        key: \"y\",\n      },\n    ],\n    [\n      {\n        label: \"宽\",\n        key: \"w\",\n      },\n      {\n        label: \"高\",\n        key: \"h\",\n      },\n    ],\n  ]);\n  let rootStyle = ref([\n    [\n      {\n        label: \"宽度\",\n        key: \"width\",\n      },\n      {\n        label: \"高度\",\n        key: \"height\",\n      },\n    ],\n  ]);\n  function keyboard(type) {\n    let { width, height } = rs.value;\n    switch (type) {\n      case \"左对齐\":\n        if (!current.value) return;\n        current.value.x = 0;\n        break;\n      case \"右对齐\":\n        if (!current.value) return;\n        current.value.x = width - current.value.w;\n        break;\n      case \"顶部对齐\":\n        if (!current.value) return;\n        current.value.y = 0;\n        break;\n      case \"底部对齐\":\n        if (!current.value) return;\n        current.value.y = height - current.value.h;\n        break;\n      case \"水平居中\":\n        if (!current.value) return;\n        current.value.x = (width - current.value.w) / 2;\n        break;\n      case \"垂直居中\":\n        if (!current.value) return;\n        current.value.y = (height - current.value.h) / 2;\n        break;\n    }\n  }\n  function beforeAvatarUpload(uploadFile) {\n    return false;\n  }\n  function change(file) {\n    let fileReader = new FileReader();\n    fileReader.readAsDataURL(file.raw);\n    fileReader.onload = () => {\n      bgImg.value = fileReader.result;\n    };\n  }\n  function handlePictureCardPreview(uploadFile) {}\n  return {\n    bgImg,\n    PosAndSize,\n    rootStyle,\n    beforeAvatarUpload,\n    handlePictureCardPreview,\n    change,\n    data,\n    keyboard,\n  };\n}\n"],"names":["list"],"mappings":"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"}